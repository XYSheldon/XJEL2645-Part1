<!DOCTYPE html>
<html>

<!-- Header -->

<head>
    <link rel="stylesheet" href="../css/main.css">
    <title>ELEC2645 Embedded Systems Project</title>
</head>

<!-- Body -->

<body>
    <!-- Top matter -->
    <section>
        <nav>
            <a href="../index.html">Home</a>
            <a href="https://github.com/ELEC2645">GitHub</a>
        </nav>

        <a href="http://www.leeds.ac.uk">
            <img src="../images/logo.png" alt="University of Leeds" style="float:right;width:200px;height:80px;">
        </a>
    </section>

    <!-- Title -->
    <h1>Bitset</h1>

    <!-- new section -->
    <section>
        <h2>Introduction</h2>
        The <a href="http://www.cplusplus.com/reference/bitset/bitset/">bitset</a> class can be thought of as an array
        of bool elements and so essentially stores individual bits (i.e. <code>0</code> or <code>1</code>, or
        <code>true</code> or <code>false</code>). This makes it useful for embedded systems programming in which we
        often need to access specific bits in registers etc.

        <p>It can be used by including the following header.</p>
        <!-- HTML generated using hilite.me -->
        <div
            style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
            <pre style="margin: 0; line-height: 125%"><span style="color: #BC7A00">#include &lt;bitset&gt;</span>
</pre>
        </div>
    </section>
    <!-- new section -->
    <section>
        <h2>Creating bitsets</h2>
        <p>There are several ways to construct bitsets. We can create an empty bitset, or we can create one by
            specifying the value in decimal, hexadecimal or by providing a string that represents the binary value.</p>
        <!-- HTML generated using hilite.me -->
        <div
            style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
            <pre style="margin: 0; line-height: 125%">  std<span style="color: #666666">::</span>bitset<span style="color: #666666">&lt;8&gt;</span> my_empty_byte;
  std<span style="color: #666666">::</span>bitset<span style="color: #666666">&lt;8&gt;</span> my_byte(<span style="color: #666666">128</span>);
  std<span style="color: #666666">::</span>bitset<span style="color: #666666">&lt;8&gt;</span> another_byte(<span style="color: #666666">0x0F</span>);
  std<span style="color: #666666">::</span>bitset<span style="color: #666666">&lt;8&gt;</span> yet_another_byte(std<span style="color: #666666">::</span>string(<span style="color: #BA2121">&quot;01010101&quot;</span>));
</pre>
        </div>
        <p>When we print the bitsets, we see the binary value.</p>
        <!-- HTML generated using hilite.me -->
        <div
            style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
            <pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">// can print out the values</span>
  std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> my_empty_byte <span style="color: #666666">&lt;&lt;</span> std<span style="color: #666666">::</span>endl;
  std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> my_byte <span style="color: #666666">&lt;&lt;</span> std<span style="color: #666666">::</span>endl;
  std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> another_byte <span style="color: #666666">&lt;&lt;</span> std<span style="color: #666666">::</span>endl;
  std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> yet_another_byte <span style="color: #666666">&lt;&lt;</span> std<span style="color: #666666">::</span>endl;
</pre>
        </div>
        <p>This gives the following output.</p>
        <!-- HTML generated using hilite.me -->
        <div
            style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
            <pre style="margin: 0; line-height: 125%"><span style="color: #666666">00000000</span>
<span style="color: #666666">10000000</span>
<span style="color: #666666">00001111</span>
<span style="color: #666666">01010101</span>
</pre>
        </div>
    </section>

    <!-- new section -->
    <section>
        <h2>Modifying bits</h2>
        <p>Once we have created a bitset, it is simple to set, reset or flip individual bits.</p>
        <!-- HTML generated using hilite.me -->
        <div
            style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
            <pre style="margin: 0; line-height: 125%">  std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;Now modify a bitset:</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span>;
  <span style="color: #408080; font-style: italic">// we can modify the bitsets</span>
  my_byte.reset(<span style="color: #666666">7</span>);  <span style="color: #408080; font-style: italic">// clear bit 7</span>
  my_byte.set(<span style="color: #666666">0</span>);    <span style="color: #408080; font-style: italic">// set bit 0</span>
  my_byte.flip(<span style="color: #666666">1</span>);   <span style="color: #408080; font-style: italic">// flip bit 1</span>
  std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> my_byte <span style="color: #666666">&lt;&lt;</span> std<span style="color: #666666">::</span>endl;
</pre>
        </div>
        <p>This will produce the following output.</p>
        <!-- HTML generated using hilite.me -->
        <div
            style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
            <pre style="margin: 0; line-height: 125%">Now modify a bitset<span style="color: #666666">:</span>
<span style="color: #666666">00000011</span>
</pre>
        </div>
        <p>We can also access a specific bit using the <code>[]</code> operator, just like accessing an element of an
            array. An alternative is to use the <code>test()</code> member function. This returns a <code>bool</code>
            which reflects the state of that bit particular bit.</p>
        <!-- HTML generated using hilite.me --><div style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;Access individual bits:</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span>;
std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;Bit 7 is &quot;</span> <span style="color: #666666">&lt;&lt;</span> my_byte[<span style="color: #666666">7</span>] <span style="color: #666666">&lt;&lt;</span> std<span style="color: #666666">::</span>endl;
std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;Can also do it with the test() member function:</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span>;
std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;Bit 0 is &quot;</span> <span style="color: #666666">&lt;&lt;</span> my_byte.test(<span style="color: #666666">0</span>) <span style="color: #666666">&lt;&lt;</span> std<span style="color: #666666">::</span>endl;
</pre></div>
    <p>This would produce the following output:</p>
    <!-- HTML generated using hilite.me --><div style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #888888">Access individual bits:</span>
<span style="color: #888888">Bit 7 is 0</span>
<span style="color: #888888">Can also do it with the test() member function:</span>
<span style="color: #888888">Bit 0 is 1</span>
</pre></div>

    </section>

    <!-- new section -->
    <section>
        <h2>Bit-wise operations</h2>
        <p>Bitsets naturally support bit-wise operations (that is, logical operations on corresponding pairs of bits). It is possible to do AND (<code>&</code>), OR (<code>|</code>), XOR (<code>^</code>) and NOT (<code>~</code>).</p>
        <!-- HTML generated using hilite.me --><div style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">// some bit-wise operations</span>
std<span style="color: #666666">::</span>bitset<span style="color: #666666">&lt;4&gt;</span> a(<span style="color: #666666">5</span>);
std<span style="color: #666666">::</span>bitset<span style="color: #666666">&lt;4&gt;</span> b(<span style="color: #666666">3</span>);
std<span style="color: #666666">::</span>bitset<span style="color: #666666">&lt;4&gt;</span> z <span style="color: #666666">=</span> a <span style="color: #666666">|</span> b;  <span style="color: #408080; font-style: italic">// OR</span>
std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> a <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot; OR &quot;</span> <span style="color: #666666">&lt;&lt;</span> b <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot; = &quot;</span> <span style="color: #666666">&lt;&lt;</span> z <span style="color: #666666">&lt;&lt;</span> std<span style="color: #666666">::</span>endl; 
</pre></div>
    <p>This would produce the following output:</p>
    <!-- HTML generated using hilite.me --><div style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #888888">0101 OR 0011 = 0111</span>
</pre></div>
    </section>

    <!-- new section -->
    <section>
        <h2>Conversion</h2>
        <p>The bitset class also has handy methods for converting a bitset to (unsigned) integers and strings.</p>
        <!-- HTML generated using hilite.me -->
        <div
            style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
            <pre style="margin: 0; line-height: 125%"><span style="color: #408080; font-style: italic">// we can convert a bitset to an integer (unsigned long)</span>
  <span style="color: #B00040">unsigned</span> <span style="color: #B00040">long</span> byte_value <span style="color: #666666">=</span> my_byte.to_ulong();
  std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;The byte has a value &quot;</span> <span style="color: #666666">&lt;&lt;</span> byte_value <span style="color: #666666">&lt;&lt;</span> std<span style="color: #666666">::</span>endl;
  <span style="color: #408080; font-style: italic">// and also to a string</span>
  std<span style="color: #666666">::</span>string byte_string <span style="color: #666666">=</span> my_byte.to_string();
  std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;The byte string is &quot;</span> <span style="color: #666666">&lt;&lt;</span> byte_string <span style="color: #666666">&lt;&lt;</span> std<span style="color: #666666">::</span>endl;
</pre>
        </div>
        <p>This could would produce the following output.</p>
        <!-- HTML generated using hilite.me -->
        <div
            style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
            <pre style="margin: 0; line-height: 125%">The byte has a value <span style="color: #666666">3</span>
The byte string is <span style="color: #666666">00000011</span>
</pre>
        </div>



    </section>

</body>


<!-- footer -->
<footer>
    <ul>
        <li> &copy Dr Craig A. Evans, 2018 </li>
        <li> <a href="mailto:C.A.Evans@leeds.ac.uk">email</a></li>
        <li> <a href="https://engineering.leeds.ac.uk/staff/347/Dr_Craig_A_Evans">webpage</a></li>
    </ul>
</footer>

</html>