<!DOCTYPE html>
<html>

<!-- Header -->

<head>
    <link rel="stylesheet" href="../css/main.css">
    <title>ELEC2645 Embedded Systems Project</title>
</head>

<!-- Body -->

<body>
    <!-- Top matter -->
    <section>
        <nav>
            <a href="../index.html">Home</a>
            <a href="https://github.com/ELEC2645">GitHub</a>
        </nav>

        <a href="http://www.leeds.ac.uk">
    <img src="../images/logo.png" alt="University of Leeds" style="float:right;width:200px;height:80px;">
    </a>
    </section>

    <!-- Title -->
    <h1>Enums and Structs</h1>

    <!-- Introduction -->
    <section>
        <h2>Introduction</h2>
        <p>We will now look at some useful C++ language features and look at some examples of how they can be used.</p>
    </section>

    <!-- Enum -->
    <section>
        <h2>Enum</h2>
        <p>An enum, or <i>enumerated type</i>, is a data type from the C language that consists of a group of elements as defined by the programmer. Each of these types is represented by an integer value. The first value is equivalent to 0, the second equal to 1 and so on. They can be useful for making code more readable. For instance, you may want to represent different fruit in your code. You could do this using an int, and give a value 0 to an apple, a value 1 to a banana and so on. However, you may forget the values for each fruit and it could be hard for another developer working on your code to follow. Instead you could create an enum like so</p>

        <p><i>main.cpp</i></p>

        <!-- HTML generated using hilite.me -->
        <div style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
            <table>
                <tr>
                    <td>
                        <pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre>
                    </td>
                    <td>
                        <pre style="margin: 0; line-height: 125%"><span style="color: #BC7A00">#include &lt;iostream&gt;</span>

<span style="color: #408080; font-style: italic">// constants in the list are assigned integers: 0,1,2 etc.</span>
<span style="color: #008000; font-weight: bold">enum</span> Vegetable { Potato, Carrot, Onion };
<span style="color: #008000; font-weight: bold">enum</span> Fruit { Apple, Banana, Pear };

<span style="color: #B00040">int</span> <span style="color: #0000FF">main</span>() {
  <span style="color: #408080; font-style: italic">// create enum types and assign values (both are 0)</span>
  Vegetable veg <span style="color: #666666">=</span> Potato;
  Fruit fruit <span style="color: #666666">=</span> Apple;
  <span style="color: #408080; font-style: italic">// we can directly compare as they are essentially integers</span>
  <span style="color: #008000; font-weight: bold">if</span> (fruit <span style="color: #666666">==</span> veg) {
    std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;The types are the same!</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span>;
  }
  <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0</span>;
}
</pre>
                    </td>
                </tr>
            </table>
        </div>

        <p>We can now create a variable of type 'Fruit' and assign it the values 'Apple', 'Banana' and 'Pear' which have the integer values 0, 1 and 2 respectively. This makes the code much more readable.</p>

        <p>However, this code also demonstrates a potential problem when using enums. We have also created an enum for Vegetables. We then use the equivalence operator to check whether an apple is the same as a potato. Since they are both enums and in this case, both have the binary value 0, the operation will return true! In the eyes of the code, it considers an apple and potato to be equivalent. This could cause problems, imagine a recipe app getting potatoes and apples mixed up. I certainly would not like to eat potato crumble and custard! Or a jacket apple with beans and cheese!</p>
    </section>

    <!-- Enum Class -->
    <section>
        <h2>Enum Class</h2>

        <p>We can avoid potential problems with using enums by using enum classes. These were introduced in C++11 and are very similar to standard enum's. The main difference is that the enum values are local to the enum class and cannot be assigned to other data-types. The above example re-written using enum classes is shown below.</p>

        <p><i>main.cpp</i></p>

        <!-- HTML generated using hilite.me -->
        <div style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
            <table>
                <tr>
                    <td>
                        <pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre>
                    </td>
                    <td>
                        <pre style="margin: 0; line-height: 125%"><span style="color: #BC7A00">#include &lt;iostream&gt;</span>

<span style="color: #008000; font-weight: bold">enum</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Vegetable</span> { Potato, Carrot, Onion };
<span style="color: #008000; font-weight: bold">enum</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Fruit</span> { Apple, Banana, Pear };

<span style="color: #B00040">int</span> <span style="color: #0000FF">main</span>() {
  <span style="color: #408080; font-style: italic">// create enum class types</span>
  Vegetable veg <span style="color: #666666">=</span> Vegetable<span style="color: #666666">::</span>Potato;
  Fruit fruit <span style="color: #666666">=</span> Fruit<span style="color: #666666">::</span>Apple;

  <span style="color: #408080; font-style: italic">// this causes a compile error as the types are now different</span>
  <span style="color: #008000; font-weight: bold">if</span> (fruit <span style="color: #666666">==</span> veg) {
    std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;The types are the same!</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&quot;</span>;
  }

  <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0</span>;
}
</pre>
                    </td>
                </tr>
            </table>
        </div>

        <p>If you try and compile the above code, you will now get an error, preventing from bugs creeping into your code. Notice how similar code is, we just need to add the <i>class</i> keyword when creating the enum class and then use the scope operator :: to tell the compiler which enum class the value belongs to.</p>

        <p>You should use enum classes in your code rather than enum.</p>
    </section>

    <!-- Struct -->
    <section>
        <h2>Struct</h2>

        <p>Another useful language feature is a struct. A struct allows us to create a custom data structure. We can essentially group together multiple variables of different types (e.g. int, float, string) into a single structure. These are especially useful for returning multiple (related) values from a function. We know that in C/C++ we can only return a single variable using a return statement. Suppose we have a function for an embedded system that calculates the x,y and z component of acceleration using an accelerometer. Rather than having separate functions to get the x,y and z components individually, you can just have one function and group the x,y and z components together into a single structure represting a 3D vector.</p>

        <p>The example below shows how to define a structure to represent a two-dimensional point (i.e. an x and a y co-ordinate). It also shows the various ways of initialising and assigning values. Note that some methods are only possible in C++11 and newer.</p>

        <p><i>main.cpp</i></p>

        <!-- HTML generated using hilite.me -->
        <div style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
            <table>
                <tr>
                    <td>
                        <pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre>
                    </td>
                    <td>
                        <pre style="margin: 0; line-height: 125%"><span style="color: #BC7A00">#include &lt;iostream&gt;</span>

<span style="color: #008000; font-weight: bold">struct</span> Point2D {
  <span style="color: #B00040">int</span> x;
  <span style="color: #B00040">int</span> y;
};

<span style="color: #B00040">int</span> <span style="color: #0000FF">main</span>() {
  <span style="color: #408080; font-style: italic">// create a 2D point struct and initialise using an initialiser list</span>
  Point2D origin <span style="color: #666666">=</span> {<span style="color: #666666">0</span>, <span style="color: #666666">0</span>};
  <span style="color: #408080; font-style: italic">// in C++11, we can also initialise using uniform initialisation</span>
  Point2D destination{<span style="color: #666666">45</span>, <span style="color: #666666">76</span>};
  <span style="color: #408080; font-style: italic">// we can also create an &#39;empty&#39; struct</span>
  Point2D corner;
  <span style="color: #408080; font-style: italic">// prior to C++11, we would have to assign values to variables individually</span>
  corner.x <span style="color: #666666">=</span> <span style="color: #666666">10</span>;
  corner.y <span style="color: #666666">=</span> <span style="color: #666666">5</span>;
  <span style="color: #408080; font-style: italic">// since C++11, we can assign values using a list</span>
  corner <span style="color: #666666">=</span> {<span style="color: #666666">12</span>, <span style="color: #666666">15</span>};
  <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0</span>;
}
</pre>
                    </td>
                </tr>
            </table>
        </div>
    </section>

    <!-- Struct vs. Class -->
    <section>
        <h2>Struct vs. Class</h2>
    </section>

    <p>In C++, a struct is actually very similar to a class. In the last example, we just saw a struct with member variables, but it is actually possible to add methods to a struct. Imagine a struct to represent a vector that contains an x and y component. We could easily add a method to get the magnitude of the vector. Therefore the struct will have member variables and member methods...sounds very similar to a class! The only real difference is that in a struct the members are public by default, whereas with a class, we would have to use the <i>public</i> keyword. The code below implements the same functionality using a class and a struct. Note how similar the code is.</p>

    <!-- HTML generated using hilite.me -->
    <div style="background: #f8f8f8; overflow:auto;width:auto;font-family: 'courier new', courier, monospace;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
        <table>
            <tr>
                <td>
                    <pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre>
                </td>
                <td>
                    <pre style="margin: 0; line-height: 125%"><span style="color: #BC7A00">#include &lt;cmath&gt;</span>
<span style="color: #BC7A00">#include &lt;iostream&gt;</span>

<span style="color: #408080; font-style: italic">// in a struct, the members are public by default</span>
<span style="color: #008000; font-weight: bold">struct</span> Vector {
  <span style="color: #B00040">int</span> x;
  <span style="color: #B00040">int</span> y;
  <span style="color: #408080; font-style: italic">// magnitude of the vector</span>
  <span style="color: #B00040">int</span> <span style="color: #0000FF">mag</span>() { <span style="color: #008000; font-weight: bold">return</span> sqrt(x <span style="color: #666666">*</span> x <span style="color: #666666">+</span> y <span style="color: #666666">*</span> y); }
};
<span style="color: #408080; font-style: italic">// in a class, the members are private by default</span>
<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">VectorClass</span> {
 <span style="color: #A0A000">public:</span>
  <span style="color: #B00040">int</span> x;
  <span style="color: #B00040">int</span> y;
  <span style="color: #408080; font-style: italic">// magnitude of the vector</span>
  <span style="color: #B00040">int</span> <span style="color: #0000FF">mag</span>() { <span style="color: #008000; font-weight: bold">return</span> sqrt(x <span style="color: #666666">*</span> x <span style="color: #666666">+</span> y <span style="color: #666666">*</span> y); }
};

<span style="color: #B00040">int</span> <span style="color: #0000FF">main</span>() {
  <span style="color: #408080; font-style: italic">// Example using a struct</span>
  Vector vec <span style="color: #666666">=</span> {<span style="color: #666666">3</span>, <span style="color: #666666">4</span>};
  <span style="color: #B00040">int</span> mag <span style="color: #666666">=</span> vec.mag();
  std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;Magnitude of {&quot;</span> <span style="color: #666666">&lt;&lt;</span> vec.x <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;, &quot;</span> <span style="color: #666666">&lt;&lt;</span> vec.y <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;} = &quot;</span> <span style="color: #666666">&lt;&lt;</span> mag
            <span style="color: #666666">&lt;&lt;</span> std<span style="color: #666666">::</span>endl;
  <span style="color: #408080; font-style: italic">// Example using a class</span>
  VectorClass vec_class <span style="color: #666666">=</span> {<span style="color: #666666">3</span>, <span style="color: #666666">4</span>};
  <span style="color: #B00040">int</span> mag_class <span style="color: #666666">=</span> vec.mag();
  std<span style="color: #666666">::</span>cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;Magnitude of {&quot;</span> <span style="color: #666666">&lt;&lt;</span> vec_class.x <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;, &quot;</span> <span style="color: #666666">&lt;&lt;</span> vec_class.y
            <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;} = &quot;</span> <span style="color: #666666">&lt;&lt;</span> mag_class <span style="color: #666666">&lt;&lt;</span> std<span style="color: #666666">::</span>endl;
  <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0</span>;
}
</pre>
                </td>
            </tr>
        </table>
    </div>

    <p>Despite the almost interchangable nature of classes and structs, the most common convention appears to be the use of structs for grouping together variables, without any methods (sometimes called 'plain-old data' or POD). Classes tend to be used when there are member methods as well as member variables. It is recommended that you stick to this convention.</p>
</body>


<!-- footer -->
<footer>
    <ul>
        <li> &copy Dr Craig A. Evans, 2018 </li>
        <li> <a href="mailto:C.A.Evans@leeds.ac.uk">email</a></li>
        <li> <a href="https://engineering.leeds.ac.uk/staff/347/Dr_Craig_A_Evans">webpage</a></li>
    </ul>
</footer>

</html>
